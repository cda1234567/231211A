# Excel 合併工具 (Python 版本)

這是一個將原始 C# WinForms 應用程式轉換為 Python 的 Excel 資料處理工具。

## 功能特色

- **Excel 檔案處理**：支援 .xls, .xlsx, .xlsm, .xlsb 格式
- **拖曳支援**：可以從外部拖曳 Excel 檔案到清單中
- **進度顯示**：即時顯示處理進度
- **資料比對與合併**：根據特定欄位進行資料比對和合併
- **格式化處理**：自動設定字體格式和顏色標示
- **檔案管理**：自動建立時間戳記資料夾並管理檔案命名
- **網路路徑備援**：網路路徑無法存取時自動使用本地路徑
- **程序管理**：自動關閉 Excel 程序，避免殘留程序

## 安裝需求

### 系統需求
- Python 3.7 或更新版本
- Microsoft Excel (用於 xlwings 操作)

### 安裝依賴套件
```bash
pip install -r requirements.txt
```

### 拖曳功能測試
```bash
python test_drag_drop.py
```

## 使用方法

1. **執行程式**
   ```bash
   python excel_merger.py
   ```

2. **新增檔案**
   - 點擊「新增檔案」按鈕選擇 Excel 檔案
   - 或直接拖曳檔案到清單中

3. **檔案排序**
   - 第一個檔案將作為主檔案
   - 其他檔案將作為次要檔案進行處理

4. **執行處理**
   - 點擊「執行」按鈕開始處理
   - 程式會自動建立輸出資料夾並處理檔案

## 資料處理邏輯

程式會根據以下邏輯處理 Excel 資料：

1. **資料比對**：比對次要檔案第3欄與主檔案第1欄
2. **欄位處理**：
   - 第7欄：取最後8位數字作為標題
   - 第6欄：整數值處理
   - 第8欄：條件性整數處理
   - 第10欄：四捨五入處理，負值標示為紅色
3. **格式化**：自動設定 Arial 字體、9號字體大小、自動換行

## 輸出

- **預設儲存位置**：`\\St-nas\個人資料夾\Andy\excel\YYYY-MM-DD-HH-MM-SS\`
- **備援儲存位置**：如果網路路徑無法存取，會自動儲存到 `./output_YYYY-MM-DD-HH-MM-SS\`
- 資料夾名稱格式：`YYYY-MM-DD-HH-MM-SS`
- 主檔案會加上 `_main` 後綴

## 注意事項

- 確保有足夠的磁碟空間
- 處理過程中請勿關閉 Excel 程式
- 如遇到錯誤，程式會自動強制關閉 Excel 程序

## 版本資訊

- 版本：Rev2
- 原始語言：C# WinForms
- 轉換語言：Python + tkinter + xlwings 